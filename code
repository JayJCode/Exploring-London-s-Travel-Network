-- most_popular_transport_types
SELECT 
	TFL.JOURNEYS.JOURNEY_TYPE, 
	SUM(TFL.JOURNEYS.JOURNEYS_MILLIONS) AS TOTAL_JOURNEYS_MILLIONS
FROM
	TFL.JOURNEYS
GROUP BY
	TFL.JOURNEYS.JOURNEY_TYPE
ORDER BY
	SUM(TFL.JOURNEYS.JOURNEYS_MILLIONS) DESC;

-- emirates_airline_popularity
SELECT 
	TFL.JOURNEYS.MONTH,
	TFL.JOURNEYS.YEAR,
	ROUND(TFL.JOURNEYS.JOURNEYS_MILLIONS, 2) AS ROUNDED_JOURNEYS_MILLIONS
FROM 
	TFL.JOURNEYS
WHERE
	TFL.JOURNEYS.JOURNEY_TYPE = 'Emirates Airline'
	AND TFL.JOURNEYS.JOURNEYS_MILLIONS IS NOT NULL
ORDER BY
	ROUNDED_JOURNEYS_MILLIONS DESC
LIMIT 
	5;

-- least_popular_years_tube
SELECT 
    TFL.JOURNEYS.YEAR, 
    TFL.JOURNEYS.JOURNEY_TYPE, 
    SUM(TFL.JOURNEYS.JOURNEYS_MILLIONS) AS TOTAL_JOURNEYS_MILLIONS
FROM 
    TFL.JOURNEYS
WHERE 
    TFL.JOURNEYS.JOURNEY_TYPE = 'Underground & DLR'
GROUP BY 
    TFL.JOURNEYS.YEAR, TFL.JOURNEYS.JOURNEY_TYPE
ORDER BY
    TOTAL_JOURNEYS_MILLIONS ASC
LIMIT
	5;
